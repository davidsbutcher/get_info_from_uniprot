#### {{basename(filelist[[i]])}}\n\n

  {{bin_size <- 1000
  bins <-  seq.int(0, 200000, by = bin_size)
  
  plot <- 
  results_proteoform[[i]] %>% 
  select(c("AverageMass", "fraction")) %>% 
  mutate(mass_bin = cut(AverageMass, breaks = bins, labels = FALSE)) %>%
  group_by(fraction, mass_bin) %>% 
  summarize(n()) %>%
  mutate(mass_bin =  (mass_bin * bin_size) - bin_size) %>% 
  rename("Proteoform Count" = `n()`) %>% 
  ggplot(aes(mass_bin, fraction, fill = `Proteoform Count`)) +
  geom_tile() +
  scale_fill_viridis_c(option = "C", direction = -1) +
  xlim(0, 100000) +
  labs(x = "Mass Bin",
       y = "Fraction") +
  theme_minimal()


plotly::ggplotly(plot)}}
                     
\n\n